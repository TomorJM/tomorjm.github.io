<!DOCTYPE html>
<html lang="en">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  
  
  
  
  
  <link rel="prev" href="https://example.com/ios-multi-language/" />
  <link rel="next" href="https://example.com/kubead-in-centos7/" />
  <link rel="canonical" href="https://example.com/learn-graphql-java/" />
  <link rel='shortcut icon' type='image/x-icon' href='/favicon.ico' />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           å¼€å§‹ä½¿ç”¨GraphQL Javaå’ŒSpring Boot | TomorJM - Love and Share.
       
  </title>
  <meta name="title" content="å¼€å§‹ä½¿ç”¨GraphQL Javaå’ŒSpring Boot | TomorJM - Love and Share.">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="å¼€å§‹ä½¿ç”¨GraphQL Javaå’ŒSpring Boot"/>
<meta name="twitter:description" content="è¿™æ˜¯ä¸€ç¯‡ä¸ºæƒ³è¦ç”¨Javaæ­å»ºGraphQLæœåŠ¡å™¨çš„å°ä¼™ä¼´ä»¬å‡†å¤‡çš„æ•™ç¨‹ã€‚éœ€è¦ä½ æœ‰ä¸€å®šçš„Spring Bootå’ŒJavaå¼€å‘ç›¸å…³çŸ¥è¯†ï¼Œè™½ç„¶æˆ‘ä»¬ç®€è¦"/>

  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "å¼€å§‹ä½¿ç”¨GraphQL Javaå’ŒSpring Boot",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https:\/\/example.com\/learn-graphql-java\/"
  },
  "image": {
    "@type": "ImageObject",
    "url": "https:\/\/example.com\/cover.png",
    "width":  800 ,
    "height":  600 
  },
  "genre": "posts",
  
  "wordcount":  4667 ,
  "url": "https:\/\/example.com\/learn-graphql-java\/",
  "datePublished": "2019-03-12T00:00:00\x2b00:00",
  "dateModified": "2019-03-12T00:00:00\x2b00:00",
  
  "publisher": {
    "@type": "Organization",
    "name": "Fastbyte01",
    "logo": {
      "@type": "ImageObject",
      "url": "https:\/\/example.com\/logo.png",
      "width":  127 ,
      "height":  40 
    }
  },
  "author": {
    "@type": "Person",
    "name": "Fastbyte01"
  },
  "description": ""
}
</script>
</head>

  



  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    
        <div class="top-scroll-bar"></div>
    
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="https://example.com">TomorJM - Love and Share.</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/list/" title="">ğŸ“–</a>
                
                <a class="menu-item" href="/about" title="">About</a>
                
                <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-sun"></i></a>&nbsp;
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
    
        <div class="top-scroll-bar"></div>
    
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-sun"></i></a>&nbsp;<a href="https://example.com">TomorJM - Love and Share.</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/list/" title="">ğŸ“–</a>
                
                <a class="menu-item" href="/about" title="">About</a>
                
        </div>
    </div>
</nav>

    	 <main class="main">
          <div class="container">
      		
<article class="post-warp">
    <header class="post-header">
        <h1 class="post-title">å¼€å§‹ä½¿ç”¨GraphQL Javaå’ŒSpring Boot</h1>
        <div class="post-meta">
            Written by <a href="https://example.com" rel="author">JaimeZhang</a> with â™¥ 
                <span class="post-time">
                    on <time datetime=2019-03-12 >12 March 2019</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://example.com/categories/%E6%8A%80%E6%9C%AF/"> æŠ€æœ¯ </a>
                        
                </span>
                <i class="iconfont icon-timer"></i>
                10 min
        </div>
    </header>
    <div class="post-content">
        

        
            
        

        
        
     
          
          
          

          
          
          

          

<p>è¿™æ˜¯ä¸€ç¯‡ä¸ºæƒ³è¦ç”¨Javaæ­å»ºGraphQLæœåŠ¡å™¨çš„å°ä¼™ä¼´ä»¬å‡†å¤‡çš„æ•™ç¨‹ã€‚éœ€è¦ä½ æœ‰ä¸€å®šçš„Spring Bootå’ŒJavaå¼€å‘ç›¸å…³çŸ¥è¯†ï¼Œè™½ç„¶æˆ‘ä»¬ç®€è¦ä»‹ç»äº†GraphQLï¼Œä½†æ˜¯æœ¬æ•™ç¨‹çš„é‡ç‚¹æ˜¯ç”¨Javaå¼€å‘ä¸€ä¸ªGraphQLæœåŠ¡å™¨ã€‚</p>

<h2 id="ä¸‰åˆ†é’Ÿä»‹ç»graphql">ä¸‰åˆ†é’Ÿä»‹ç»GraphQL</h2>

<p>GraphQLæ˜¯ä¸€é—¨ä»æœåŠ¡å™¨æ£€ç´¢æ•°æ®çš„æŸ¥è¯¢è¯­è¨€ã€‚åœ¨æŸäº›åœºæ™¯ä¸‹å¯ä»¥æ›¿æ¢RESTã€SOAPå’ŒgRPCã€‚è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æƒ³è¦ä»ä¸€ä¸ªåœ¨çº¿å•†åŸçš„åç«¯è·å–æŸä¸€ä¸ªæœ¬ä¹¦çš„è¯¦æƒ…ã€‚</p>

<p>ä½ ä½¿ç”¨GraphQLå¾€æœåŠ¡å™¨å‘é€å¦‚ä¸‹æŸ¥è¯¢å»è·å–idä¸º&rdquo;123&rdquo;çš„é‚£æœ¬ä¹¦çš„è¯¦æƒ…:</p>

<pre><code class="language-json">{
  bookById(id: &quot;book-1&quot;){
    id
    name
    pageCount
    author {
      firstName
      lastName
    }
  }
}
</code></pre>

<p>è¿™ä¸æ˜¯ä¸€æ®µJSON(å°½ç®¡å®ƒçœ‹èµ·æ¥éå¸¸åƒ)ï¼Œè€Œæ˜¯ä¸€æ¡GraphQLæŸ¥è¯¢ã€‚å®ƒåŸºæœ¬ä¸Šè¡¨ç¤º:</p>

<ul>
<li>æŸ¥è¯¢æŸä¸ªç‰¹å®šidçš„ä¹¦</li>
<li>ç»™æˆ‘é‚£æœ¬ä¹¦çš„idã€nameã€pageCountã€author</li>
<li>å¯¹äºauthoræˆ‘æƒ³çŸ¥é“firstNameå’ŒlastName</li>
</ul>

<p>å“åº”æ˜¯ä¸€æ®µæ™®é€šJSON:</p>

<pre><code class="language-json">{
  &quot;bookById&quot;:
  {
    &quot;id&quot;:&quot;book-1&quot;,
    &quot;name&quot;:&quot;Harry Potter and the Philosopher's Stone&quot;,
    &quot;pageCount&quot;:223,
    &quot;author&quot;: {
      &quot;firstName&quot;:&quot;Joanne&quot;,
      &quot;lastName&quot;:&quot;Rowling&quot;
    }
  }
}
</code></pre>

<p>é™æ€ç±»å‹æ˜¯GraphQLæœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€:æœåŠ¡å™¨æ˜ç¡®åœ°çŸ¥é“ä½ æƒ³è¦æŸ¥è¯¢çš„æ¯ä¸ªå¯¹è±¡éƒ½æ˜¯ä»€ä¹ˆæ ·å­çš„å¹¶ä¸”ä»»ä½•clientéƒ½å¯ä»¥&rdquo;å†…çœ&rdquo;äºæœåŠ¡å™¨å¹¶è¯·æ±‚&rdquo;schema&rdquo;ã€‚schemaæè¿°çš„æ˜¯æŸ¥è¯¢å¯èƒ½æ˜¯å“ªäº›æƒ…å†µå¹¶ä¸”ä½ å¯ä»¥æ‹¿åˆ°å“ªäº›å­—æ®µã€‚(æ³¨æ„:å½“æåŠschemaæ—¶ï¼Œæˆ‘ä»¬ç»å¸¸æŒ‡çš„æ˜¯&rdquo;GraphQL Schema&rdquo;ï¼Œè€Œä¸æ˜¯åƒ&rdquo;JSON Schema&rdquo;æˆ–è€…&rdquo;Database Schema&rdquo;)</p>

<p>ä¸Šé¢æåŠçš„æŸ¥è¯¢çš„schemaæ˜¯è¿™æ ·æè¿°çš„:</p>

<pre><code class="language-js">type Query {
  bookById(id: ID): Book
}

type Book {
  id: ID
  name: String
  pageCount: Int
  author: Author
}

type Author {
  id: ID
  firstName: String
  lastName: String
}
</code></pre>

<p>è¿™ç¯‡æ•™ç¨‹å°†å…³æ³¨äºå¦‚ä½•ç”¨Javaå®ç°ä¸€ä¸ªæœ‰ç€è¿™ç§schemaçš„GraphQLæœåŠ¡å™¨ã€‚</p>

<p>æˆ‘ä»¬ä»…ä»…è§¦åŠäº†GraphQLçš„ä¸€äº›åŸºæœ¬åŠŸèƒ½ã€‚æ›´å¤šå†…å®¹å¯ä»¥å»å®˜ç½‘æŸ¥çœ‹
<a href="https://graphql.github.io/learn/" rel="nofollow noreferrer" target="_blank">https://graphql.github.io/learn/</a></p>

<h2 id="graphql-java-é¢„è§ˆ">GraphQL Java é¢„è§ˆ</h2>

<p><a href="https://www.graphql-java.com/" rel="nofollow noreferrer" target="_blank">GraphQL Java</a>æ˜¯GraphQLçš„Java(æœåŠ¡å™¨)å®ç°ã€‚GraphQL Java Github orgä¸­æœ‰å‡ ä¸ªGitä»“åº“ã€‚å…¶ä¸­æœ€é‡è¦çš„ä¸€ä¸ªæ˜¯<a href="https://github.com/graphql-java/graphql-java" rel="nofollow noreferrer" target="_blank">GraphQL Java å¼•æ“</a>ï¼Œå®ƒæ˜¯å…¶ä»–æ‰€æœ‰ä¸œè¥¿çš„åŸºç¡€ã€‚</p>

<p>GraphQL Javaå¼•æ“æœ¬èº«åªå…³å¿ƒæ‰§è¡ŒæŸ¥è¯¢ã€‚å®ƒä¸å¤„ç†ä»»ä½•HTTPæˆ–JSONç›¸å…³ä¸»é¢˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨<a href="https://github.com/graphql-java/graphql-java-spring" rel="nofollow noreferrer" target="_blank">GraphQL Java Spring Boot</a> adapterï¼Œå®ƒé€šè¿‡Spring Bootåœ¨HTTPä¸Šæš´éœ²APIã€‚</p>

<p>åˆ›å»ºGraphQL JavaæœåŠ¡å™¨çš„ä¸»è¦æ­¥éª¤å¦‚ä¸‹:</p>

<ol>
<li>å®šä¹‰GraphQL Schemaã€‚</li>
<li>å†³å®šå¦‚ä½•è·å–éœ€è¦æŸ¥è¯¢çš„å®é™…æ•°æ®ã€‚</li>
</ol>

<h2 id="æˆ‘ä»¬çš„ç¤ºä¾‹api-è·å–å›¾ä¹¦è¯¦ç»†ä¿¡æ¯">æˆ‘ä»¬çš„ç¤ºä¾‹API:è·å–å›¾ä¹¦è¯¦ç»†ä¿¡æ¯</h2>

<p>æˆ‘ä»¬çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºå°†æ˜¯ä¸€ä¸ªç®€å•çš„APIï¼Œç”¨äºè·å–ç‰¹å®šä¹¦ç±çš„è¯¦ç»†ä¿¡æ¯ã€‚è¿™ä¸ªAPIå¹¶ä¸æ˜¯å¾ˆå…¨é¢ï¼Œä½†å¯¹äºæœ¬æ•™ç¨‹æ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚</p>

<h2 id="åˆ›å»ºä¸€ä¸ªspring-bootåº”ç”¨ç¨‹åº">åˆ›å»ºä¸€ä¸ªSpring Bootåº”ç”¨ç¨‹åº</h2>

<p>åˆ›å»ºSpringåº”ç”¨ç¨‹åºçš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨<a href="https://start.spring.io/" rel="nofollow noreferrer" target="_blank">https://start.spring.io/</a>ä¸Šçš„â€œSpring Initializrâ€ã€‚</p>

<p>é€‰æ‹©:</p>

<ul>
<li>Gradle Project</li>
<li>Java</li>
<li>Spring Boot 2.1.x</li>
</ul>

<p>å¯¹äºæˆ‘ä»¬ä½¿ç”¨çš„é¡¹ç›®å…ƒæ•°æ®:</p>

<ul>
<li>Group: <code>com.graphql-java.tutorial</code></li>
<li>Artifact: <code>book-details</code></li>
</ul>

<p>è‡³äºdependency(ä¾èµ–é¡¹)ï¼Œæˆ‘ä»¬åªé€‰æ‹©Webã€‚</p>

<p>ç‚¹å‡»<code>Generate Project</code>ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨Spring Boot appäº†ã€‚æ‰€æœ‰åé¢æåˆ°çš„æ–‡ä»¶å’Œè·¯å¾„éƒ½æ˜¯ä¸è¿™ä¸ªGenerate Projectç›¸å…³çš„ã€‚</p>

<p>æˆ‘ä»¬åœ¨<code>build.gradle</code>çš„<code>dependencies</code>éƒ¨åˆ†ä¸ºæˆ‘ä»¬çš„é¡¹ç›®æ·»åŠ äº†ä¸‰ä¸ªä¾èµ–é¡¹:</p>

<p>å‰ä¸¤ä¸ªæ˜¯GraphQL Javaå’ŒGraphQL Java Springï¼Œç„¶åæˆ‘ä»¬è¿˜æ·»åŠ äº†<a href="https://github.com/google/guava" rel="nofollow noreferrer" target="_blank">Google Guava</a>ã€‚Guavaå¹¶ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†å®ƒä¼šè®©æˆ‘ä»¬çš„ç”Ÿæ´»æ›´å®¹æ˜“ä¸€ç‚¹ã€‚</p>

<p>ä¾èµ–é¡¹çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:</p>

<pre><code class="language-java">dependencies {
    implementation 'com.graphql-java:graphql-java:11.0' // NEW
    implementation 'com.graphql-java:graphql-java-spring-boot-starter-webmvc:1.0' // NEW
    implementation 'com.google.guava:guava:26.0-jre' // NEW
    implementation 'org.springframework.boot:spring-boot-starter-web'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}
</code></pre>

<h2 id="schema">Schema</h2>

<p>æˆ‘ä»¬æ­£åœ¨<code>src/main/resources</code>ä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶<code>schema.graphqls</code>ï¼Œå®ƒåŒ…å«ä»¥ä¸‹å†…å®¹:</p>

<pre><code class="language-js">type Query {
  bookById(id: ID): Book
}

type Book {
  id: ID
  name: String
  pageCount: Int
  author: Author
}

type Author {
  id: ID
  firstName: String
  lastName: String
}
</code></pre>

<p>æ­¤schemaå®šä¹‰äº†ä¸€ä¸ªé¡¶å±‚å­—æ®µ(åœ¨<code>Query</code>ç±»å‹ä¸­):<code>bookById</code>ï¼Œå®ƒè¿”å›ç‰¹å®šå›¾ä¹¦çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>

<p>å®ƒè¿˜å®šä¹‰äº†ç±»å‹<code>Book</code>ï¼Œå®ƒåŒ…å«äº†:<code>id</code>ã€<code>name</code>ã€<code>pageCount</code>å’Œ<code>author</code>ã€‚<code>author</code>å±äº<code>Author</code>ç±»å‹ï¼Œåœ¨<code>Book</code>ä¹‹åå®šä¹‰ã€‚</p>

<blockquote>
<p>ä¸Šé¢æ˜¾ç¤ºçš„ç”¨äºæè¿°æ¨¡å¼çš„ç‰¹å®šäºåŸŸçš„è¯­è¨€ç§°ä¸ºæ¨¡å¼å®šä¹‰è¯­è¨€æˆ–SDLã€‚æ›´å¤šç»†èŠ‚å¯ä»¥åœ¨<a href="https://graphql.org/learn/schema/" rel="nofollow noreferrer" target="_blank">è¿™é‡Œ</a>æ‰¾åˆ°ã€‚</p>
</blockquote>

<p>ä¸€æ—¦æˆ‘ä»¬æœ‰äº†è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬å°±éœ€è¦é€šè¿‡è¯»å–æ–‡ä»¶å¹¶è§£æå®ƒï¼Œç„¶åæ·»åŠ ä»£ç æ¥ä¸ºå®ƒè·å–æ•°æ®ï¼Œä»è€Œâ€œè®©å®ƒæ´»èµ·æ¥â€ã€‚</p>

<p>æˆ‘ä»¬åœ¨<code>com.graphqljava.tutorial.bookdetails</code>åŒ…ä¸­åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„<code>GraphQLProvider</code>ç±»ã€‚<code>init</code>æ–¹æ³•å°†åˆ›å»ºä¸€ä¸ªGraphQLå®ä¾‹:</p>

<pre><code class="language-java">@Component
public class GraphQLProvider {

    private GraphQL graphQL;

    @Bean
    public GraphQL graphQL() {
        return graphQL;
    }

    @PostConstruct
    public void init() throws IOException {
        URL url = Resources.getResource(&quot;schema.graphqls&quot;);
        String sdl = Resources.toString(url, Charsets.UTF_8);
        GraphQLSchema graphQLSchema = buildSchema(sdl);
        this.graphQL = GraphQL.newGraphQL(graphQLSchema).build();
    }

    private GraphQLSchema buildSchema(String sdl) {
      // TODO: we will create the schema here later
    }
}
</code></pre>

<p>æˆ‘ä»¬ä½¿ç”¨<code>Guava</code>èµ„æºä»ç±»è·¯å¾„è¯»å–æ–‡ä»¶ï¼Œç„¶ååˆ›<code>GraphQLSchema</code>å’Œ<code>GraphQL</code>å®ä¾‹ã€‚è¿™ä¸ª<code>GraphQL</code>å®ä¾‹é€šè¿‡ä½¿ç”¨<code>@Bean</code>æ³¨è§£çš„<code>GraphQL()</code>æ–¹æ³•ä½œä¸ºSpring Beanæš´éœ²å‡ºå»ã€‚GraphQL Java Springé€‚é…å™¨å°†ä½¿ç”¨è¯¥<code>GraphQL</code>å®ä¾‹ï¼Œä½¿æˆ‘ä»¬çš„schemaå¯ä»¥é€šè¿‡é»˜è®¤url<code>/GraphQL</code>è¿›è¡ŒHTTPè®¿é—®ã€‚</p>

<p>æˆ‘ä»¬è¿˜éœ€è¦åšçš„æ˜¯å®ç°<code>buildSchema</code>æ–¹æ³•ï¼Œå®ƒåˆ›å»º<code>GraphQLSchema</code>å®ä¾‹ï¼Œå¹¶è¿æ¥ä»£ç æ¥è·å–æ•°æ®:</p>

<pre><code class="language-java">@Autowired
GraphQLDataFetchers graphQLDataFetchers;

private GraphQLSchema buildSchema(String sdl) {
    TypeDefinitionRegistry typeRegistry = new SchemaParser().parse(sdl);
    RuntimeWiring runtimeWiring = buildWiring();
    SchemaGenerator schemaGenerator = new SchemaGenerator();
    return schemaGenerator.makeExecutableSchema(typeRegistry, runtimeWiring);
}

private RuntimeWiring buildWiring() {
    return RuntimeWiring.newRuntimeWiring()
        .type(newTypeWiring(&quot;Query&quot;)
        .dataFetcher(&quot;bookById&quot;, graphQLDataFetchers.getBookByIdDataFetcher()))
        .type(newTypeWiring(&quot;Book&quot;)
        .dataFetcher(&quot;author&quot;, graphQLDataFetchers.getAuthorDataFetcher()))
        .build();
}
</code></pre>

<p><code>TypeDefinitionRegistry</code>æ˜¯schemaæ–‡ä»¶çš„è§£æç‰ˆæœ¬ã€‚SchemaGeneratorå°†<code>TypeDefinitionRegistry</code>ä¸<code>RuntimeWiring</code>ç»“åˆèµ·æ¥ï¼Œå®é™…ç”Ÿæˆ<code>GraphQLSchema</code>ã€‚</p>

<p><code>buildRuntimeWiring</code>ä½¿ç”¨<code>graphQLDataFetchers</code>beanæ¥æ³¨å†Œä¸¤ä¸ª<code>Datafetcher</code>s:</p>

<ul>
<li>ä¸€ä¸ªæ˜¯æ£€ç´¢å…·æœ‰ç‰¹å®šIDçš„å›¾ä¹¦ã€‚</li>
<li>ä¸€ä¸ªæ˜¯ä¸ºç‰¹å®šçš„ä¹¦æ‰¾åˆ°ä½œè€…ã€‚</li>
</ul>

<p>ä¸‹ä¸€èŠ‚å°†è§£é‡Š<code>DataFetcher</code>ä»¥åŠå¦‚ä½•å®ç°<code>GraphQLDataFetchers</code>beanã€‚</p>

<p>æ€»çš„æ¥è¯´ï¼Œåˆ›å»º<code>GraphQL</code>å’Œ<code>GraphQLSchema</code>å®ä¾‹çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„:</p>

<p><figure><img src="/images/ring.svg" data-sizes="auto" data-src="https://www.graphql-java.com/images/graphql_creation.png" alt="explain" class="lazyload"><figcaption class="image-caption">explain</figcaption></figure></p>

<h2 id="datafetchers">DataFetchers</h2>

<p>GraphQL JavaæœåŠ¡å™¨æœ€é‡è¦çš„æ¦‚å¿µå¯èƒ½æ˜¯<code>Datafetcher</code>:åœ¨æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œ<code>Datafetcher</code>è·å–ä¸€ä¸ªå­—æ®µçš„æ•°æ®ã€‚</p>

<p>å½“GraphQL Javaæ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œå®ƒä¸ºæŸ¥è¯¢ä¸­é‡åˆ°çš„æ¯ä¸ªå­—æ®µè°ƒç”¨é€‚å½“çš„<code>Datafetcher</code>ã€‚<code>DataFetcher</code>æ˜¯ä¸€ä¸ªåªæœ‰ä¸€ä¸ªæ–¹æ³•çš„æ¥å£ï¼Œå¸¦æœ‰ä¸€ä¸ªç±»å‹çš„å‚æ•°<code>DataFetcherEnvironment</code>:</p>

<pre><code class="language-java">public interface DataFetcher&lt;T&gt; {
    T get(DataFetchingEnvironment dataFetchingEnvironment) throws Exception;
}
</code></pre>

<p>é‡è¦æç¤º:æ¨¡å¼ä¸­çš„æ¯ä¸ªå­—æ®µéƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å…³è”çš„<code>DataFetcher</code>ã€‚å¦‚æœæ²¡æœ‰ä¸ºç‰¹å®šå­—æ®µæŒ‡å®šä»»ä½•<code>DataFetcher</code>ï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„<code>PropertyDataFetcher</code>ã€‚æˆ‘ä»¬ç¨åå°†æ›´è¯¦ç»†åœ°è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚</p>

<p>æˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»<code>GraphQLDataFetchers</code>ï¼Œå…¶ä¸­åŒ…å«å›¾ä¹¦å’Œä½œè€…çš„ç¤ºä¾‹åˆ—è¡¨ã€‚</p>

<p>å®Œæ•´çš„å®ç°æ˜¯è¿™æ ·çš„ï¼Œæˆ‘ä»¬å°†å¾ˆå¿«è¯¦ç»†ç ”ç©¶å®ƒ:</p>

<pre><code class="language-java">@Component
public class GraphQLDataFetchers {

    private static List&lt;Map&lt;String, String&gt;&gt; books = Arrays.asList(
            ImmutableMap.of(&quot;id&quot;, &quot;book-1&quot;,
                    &quot;name&quot;, &quot;Harry Potter and the Philosopher's Stone&quot;,
                    &quot;pageCount&quot;, &quot;223&quot;,
                    &quot;authorId&quot;, &quot;author-1&quot;),
            ImmutableMap.of(&quot;id&quot;, &quot;book-2&quot;,
                    &quot;name&quot;, &quot;Moby Dick&quot;,
                    &quot;pageCount&quot;, &quot;635&quot;,
                    &quot;authorId&quot;, &quot;author-2&quot;),
            ImmutableMap.of(&quot;id&quot;, &quot;book-3&quot;,
                    &quot;name&quot;, &quot;Interview with the vampire&quot;,
                    &quot;pageCount&quot;, &quot;371&quot;,
                    &quot;authorId&quot;, &quot;author-3&quot;)
    );

    private static List&lt;Map&lt;String, String&gt;&gt; authors = Arrays.asList(
            ImmutableMap.of(&quot;id&quot;, &quot;author-1&quot;,
                    &quot;firstName&quot;, &quot;Joanne&quot;,
                    &quot;lastName&quot;, &quot;Rowling&quot;),
            ImmutableMap.of(&quot;id&quot;, &quot;author-2&quot;,
                    &quot;firstName&quot;, &quot;Herman&quot;,
                    &quot;lastName&quot;, &quot;Melville&quot;),
            ImmutableMap.of(&quot;id&quot;, &quot;author-3&quot;,
                    &quot;firstName&quot;, &quot;Anne&quot;,
                    &quot;lastName&quot;, &quot;Rice&quot;)
    );

    public DataFetcher getBookByIdDataFetcher() {
        return dataFetchingEnvironment -&gt; {
            String bookId = dataFetchingEnvironment.getArgument(&quot;id&quot;);
            return books
                    .stream()
                    .filter(book -&gt; book.get(&quot;id&quot;).equals(bookId))
                    .findFirst()
                    .orElse(null);
        };
    }

    public DataFetcher getAuthorDataFetcher() {
        return dataFetchingEnvironment -&gt; {
            Map&lt;String,String&gt; book = dataFetchingEnvironment.getSource();
            String authorId = book.get(&quot;authorId&quot;);
            return authors
                    .stream()
                    .filter(author -&gt; author.get(&quot;id&quot;).equals(authorId))
                    .findFirst()
                    .orElse(null);
        };
    }
}
</code></pre>

<h3 id="æ•°æ®æº">æ•°æ®æº</h3>

<p>æˆ‘ä»¬ä»ç±»ä¸­çš„é™æ€åˆ—è¡¨ä¸­è·å–å›¾ä¹¦å’Œä½œè€…ã€‚è¿™åªæ˜¯ä¸ºäº†æœ¬æ•™ç¨‹è€Œåšçš„ã€‚ç†è§£GraphQLå¹¶ä¸æŒ‡å®šæ•°æ®æ¥è‡ªä½•å¤„æ˜¯éå¸¸é‡è¦çš„ã€‚è¿™å°±æ˜¯GraphQLçš„å¼ºå¤§ä¹‹å¤„:å®ƒå¯ä»¥æ¥è‡ªå†…å­˜ä¸­çš„é™æ€åˆ—è¡¨ã€æ•°æ®åº“æˆ–å¤–éƒ¨æœåŠ¡ã€‚</p>

<h3 id="book-datafetcher">Book DataFetcher</h3>

<p>æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ–¹æ³•<code>getBookByIdDataFetcher</code>è¿”å›ä¸€ä¸ª<code>DataFetcher</code>å®ç°ï¼Œè¯¥å®ç°æ¥å—ä¸€ä¸ª<code>DataFetcherEnvironment</code>å¹¶è¿”å›ä¸€æœ¬ä¹¦ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬éœ€è¦ä»<code>bookById</code>å­—æ®µè·å–idå‚æ•°ï¼Œå¹¶æ‰¾åˆ°å…·æœ‰æ­¤ç‰¹å®šidçš„å›¾ä¹¦ã€‚</p>

<p><code>String bookId = dataFetchingEnvironment.getArgument(&quot;id&quot;);</code>ä¸­çš„&rdquo;id&rdquo;ä¸ºschemaä¸­<code>bookById</code>æŸ¥è¯¢å­—æ®µä¸­çš„â€œidâ€:</p>

<pre><code class="language-json">type Query {
  bookById(id: ID): Book
}
...
</code></pre>

<h3 id="author-datafetcher">Author DataFetcher</h3>

<p>ç¬¬äºŒä¸ªæ–¹æ³•<code>getAuthorDataFetcher</code>è¿”å›ä¸€ä¸ª<code>Datafetcher</code>ï¼Œç”¨äºè·å–ç‰¹å®šä¹¦ç±çš„ä½œè€…ã€‚ä¸å‰é¢æè¿°çš„book <code>DataFetcher</code>ç›¸æ¯”ï¼Œæˆ‘ä»¬æ²¡æœ‰å‚æ•°ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªbookå®ä¾‹ã€‚æ¥è‡ªçˆ¶å­—æ®µçš„<code>DataFetcher</code>çš„ç»“æœå¯ä»¥é€šè¿‡<code>getSource</code>è·å¾—ã€‚è¿™æ˜¯ä¸€ä¸ªéœ€è¦ç†è§£çš„é‡è¦æ¦‚å¿µ:GraphQLä¸­æ¯ä¸ªå­—æ®µçš„<code>Datafetcher</code>éƒ½æ˜¯ä»¥è‡ªé¡¶å‘ä¸‹çš„æ–¹å¼è°ƒç”¨çš„ï¼Œçˆ¶å­—æ®µçš„ç»“æœæ˜¯å­<code>Datafetcherenvironment</code>çš„<code>source</code>å±æ€§ã€‚</p>

<p>ç„¶åï¼Œæˆ‘ä»¬ä½¿ç”¨å…ˆå‰è·å–çš„å›¾ä¹¦è·å–authorIdï¼Œå¹¶ä»¥æŸ¥æ‰¾ç‰¹å®šå›¾ä¹¦çš„ç›¸åŒæ–¹å¼æŸ¥æ‰¾ç‰¹å®šçš„ä½œè€…ã€‚</p>

<h3 id="default-datafetchers">Default DataFetchers</h3>

<p>æˆ‘ä»¬åªå®ç°äº†ä¸¤ä¸ª<code>Datafetcher</code>ã€‚å¦‚ä¸Šæ‰€è¿°ï¼Œå¦‚æœä¸æŒ‡å®šä¸€ä¸ªï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„<code>PropertyDataFetcher</code>ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæŒ‡çš„æ˜¯<code>Book.id</code>ã€<code>Book.name</code>ã€<code>Book.pageCount</code>ã€<code>Author.id</code>ã€<code>Author.firstName</code>å’Œ<code>Author.lastName</code>éƒ½æœ‰ä¸€ä¸ªé»˜è®¤çš„<code>PropertyDataFetcher</code>ä¸ä¹‹å…³è”ã€‚</p>

<p><code>PropertyDataFetcher</code>å°è¯•ä»¥å¤šç§æ–¹å¼æŸ¥æ‰¾Javaå¯¹è±¡ä¸Šçš„å±æ€§ã€‚ä»¥<code>java.util.Map</code>ä¸ºä¾‹, å®ƒåªæ˜¯æŒ‰é”®æŸ¥æ‰¾å±æ€§ã€‚è¿™å¯¹æˆ‘ä»¬æ¥è¯´éå¸¸å¥½ï¼Œå› ä¸ºbookå’Œauthoræ˜ å°„çš„é”®ä¸schemaä¸­æŒ‡å®šçš„å­—æ®µç›¸åŒã€‚ä¾‹å¦‚ï¼Œåœ¨æˆ‘ä»¬ä¸ºå›¾ä¹¦ç±»å‹å®šä¹‰çš„schemaä¸­ï¼Œå­—æ®µ<code>pageCount</code>å’Œbook <code>DataFetcher</code>è¿”å›ä¸€ä¸ªå¸¦æœ‰é”®<code>pageCount</code>çš„<code>Map</code>ã€‚å› ä¸ºå­—æ®µåä¸<code>Map</code>ä¸­çš„é”®ç›¸åŒ(â€œpageCountâ€)ï¼Œ<code>PropertyDateFetcher</code>æ­£å¸¸å·¥ä½œã€‚</p>

<p>è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸åŒ¹é…ï¼Œbook <code>Map</code>æœ‰ä¸€ä¸ªé”®æ˜¯<code>totalPages</code>è€Œä¸æ˜¯<code>pageCount</code>ã€‚è¿™å°†å¯¼è‡´æ¯æœ¬ä¹¦çš„<code>pageCount</code>å€¼ä¸º<code>null</code>ï¼Œå› ä¸º<code>PropertyDataFetcher</code>æ— æ³•è·å–æ­£ç¡®çš„å€¼ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¿…é¡»ä¸º<code>Book.pageCount</code>æ³¨å†Œä¸€ä¸ªæ–°çš„<code>DataFetcher</code>ã€‚å®ƒçœ‹èµ·æ¥åƒè¿™æ ·:</p>

<pre><code class="language-java">    // In the GraphQLProvider class
    private RuntimeWiring buildWiring() {
        return RuntimeWiring.newRuntimeWiring()
                .type(newTypeWiring(&quot;Query&quot;)
                        .dataFetcher(&quot;bookById&quot;, graphQLDataFetchers.getBookByIdDataFetcher()))
                .type(newTypeWiring(&quot;Book&quot;)
                        .dataFetcher(&quot;author&quot;, graphQLDataFetchers.getAuthorDataFetcher())
                        // This line is new: we need to register the additional DataFetcher
                        .dataFetcher(&quot;pageCount&quot;, graphQLDataFetchers.getPageCountDataFetcher()))
                .build();
    }

    // In the GraphQLDataFetchers class
    // Implement the DataFetcher
    public DataFetcher getPageCountDataFetcher() {
        return dataFetchingEnvironment -&gt; {
            Map&lt;String,String&gt; book = dataFetchingEnvironment.getSource();
            return book.get(&quot;totalPages&quot;);
        };
    }
...
</code></pre>

<p>è¿™ä¸ª<code>DataFetcher</code>å°†é€šè¿‡åœ¨book <code>Map</code>ä¸­æŸ¥æ‰¾æ­£ç¡®çš„é”®æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚(åŒæ ·:åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ä¸éœ€è¦è¿™ä¸ªï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰å‘½åä¸åŒ¹é…)</p>

<h2 id="è¯•ç”¨api">è¯•ç”¨API</h2>

<p>è¿™å°±æ˜¯æ„å»ºä¸€ä¸ªå¯å·¥ä½œçš„GraphQL APIæ‰€éœ€çš„å…¨éƒ¨å†…å®¹ã€‚åœ¨å¯åŠ¨Spring Bootåº”ç”¨ç¨‹åºä¹‹åï¼Œå¯ä»¥åœ¨<code>http://localhost:8080/graphql</code>ä¸Šä½¿ç”¨APIã€‚</p>

<p>å°è¯•å’Œæ¢ç´¢GraphQL APIçš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨<a href="https://github.com/prisma/graphql-playground" rel="nofollow noreferrer" target="_blank">GraphQL Playground</a>çš„å·¥å…·ã€‚ä¸‹è½½å¹¶è¿è¡Œå®ƒã€‚</p>

<p>å¯åŠ¨ä¹‹åï¼Œä½ å°†è¢«è¦æ±‚è¾“å…¥ä¸€ä¸ªURLï¼Œè¾“å…¥<code>http://localhost:8080/graphql</code>ã€‚</p>

<p>ä¹‹åï¼Œä½ å¯ä»¥æŸ¥è¯¢æˆ‘ä»¬çš„ç¤ºä¾‹APIï¼Œæ‚¨åº”è¯¥ä¼šå¾—åˆ°æˆ‘ä»¬åœ¨å¼€å§‹æ—¶æåˆ°çš„ç»“æœã€‚å®ƒåº”è¯¥æ˜¯è¿™æ ·çš„:</p>

<p><figure><img src="/images/ring.svg" data-sizes="auto" data-src="https://www.graphql-java.com/images/playground.png" alt="demo" class="lazyload"><figcaption class="image-caption">demo</figcaption></figure></p>

<h2 id="å®Œæ•´çš„ç¤ºä¾‹æºä»£ç å’Œæ›´å¤šä¿¡æ¯">å®Œæ•´çš„ç¤ºä¾‹æºä»£ç å’Œæ›´å¤šä¿¡æ¯</h2>

<p>å®Œæ•´çš„é¡¹ç›®å’Œå®Œæ•´çš„æºä»£ç å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°:<a href="https://github.com/graphql-java/tutorials/tree/master/book-details" rel="nofollow noreferrer" target="_blank">https://github.com/graphql-java/tutorials/tree/master/book-details</a></p>

<p>æœ‰å…³GraphQL Javaçš„æ›´å¤šä¿¡æ¯å¯ä»¥åœ¨<a href="https://www.graphql-java.com/documentation/" rel="nofollow noreferrer" target="_blank">æ–‡æ¡£</a>ä¸­æ‰¾åˆ°ã€‚</p>

<p>å¯¹äºä»»ä½•é—®é¢˜, æˆ‘ä»¬ä¹Ÿæœ‰<a href="https://spectrum.chat/graphql-java" rel="nofollow noreferrer" target="_blank">spectrum chat</a>æ¥å—è®¨è®ºã€‚</p>

<p>å¯¹äºç›´æ¥çš„åé¦ˆï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨æˆ‘ä»¬çš„<a href="https://twitter.com/graphql_java" rel="nofollow noreferrer" target="_blank">GraphQL Java Twitter account</a>å¸æˆ·ä¸Šæ‰¾åˆ°æˆ‘ä»¬ã€‚</p>

<blockquote>
<p>åŸæ–‡é“¾æ¥:<a href="https://www.graphql-java.com/tutorials/getting-started-with-spring-boot/" rel="nofollow noreferrer" target="_blank">Getting started with GraphQL Java and Spring Boot</a></p>

<p>è¯‘æ–‡è¿æ¥:<a href="http://www.tomorjm.com/year/03/12/%E5%BC%80%E5%A7%8B%E4%BD%BF%E7%94%A8GraphQL-Java%E5%92%8CSpring-Boot/" rel="nofollow noreferrer" target="_blank">å¼€å§‹ä½¿ç”¨GraphQL Javaå’ŒSpring Boot</a></p>

<p>ç¿»è¯‘:<a href="http://www.tomorjm.com/" rel="nofollow noreferrer" target="_blank">TomorJM</a></p>
</blockquote>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>JaimeZhang </span>
                </p>
            
           
            <p class="copyright-item">
                    <span>Words:</span>
                   <span>4667</span>
            </p>
            
            <p class="copyright-item">
                
                <span>Share:</span>
                <span>

      
        <a href="//twitter.com/share?url=https%3a%2f%2fexample.com%2flearn-graphql-java%2f&amp;text=%e5%bc%80%e5%a7%8b%e4%bd%bf%e7%94%a8GraphQL%20Java%e5%92%8cSpring%20Boot&amp;via=" target="_blank" title="Share on Twitter">
          <i class="iconfont icon-twitter"></i>
        </a>
        
      
      
        <a href="//www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fexample.com%2flearn-graphql-java%2f" target="_blank" title="Share on Facebook">
          <i class="iconfont icon-facebook"></i>
        </a>
        
      
      
      
      
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fexample.com%2flearn-graphql-java%2f&amp;title=%e5%bc%80%e5%a7%8b%e4%bd%bf%e7%94%a8GraphQL%20Java%e5%92%8cSpring%20Boot" target="_blank" title="Share on LinkedIn">
          <i class="iconfont icon-linkedin"></i>
        </a>
        
      
      
        
      
        
      

          

          

          
        <a href="//www.douban.com/recommend/?url=https%3a%2f%2fexample.com%2flearn-graphql-java%2f&amp;title=%e5%bc%80%e5%a7%8b%e4%bd%bf%e7%94%a8GraphQL%20Java%e5%92%8cSpring%20Boot" target="_blank" title="Share on Douban ">
            <i class="iconfont icon-douban"></i>
          </a>
          

          
        <a href="//service.weibo.com/share/share.php?url=https%3a%2f%2fexample.com%2flearn-graphql-java%2f&amp;appkey=&amp;title=%e5%bc%80%e5%a7%8b%e4%bd%bf%e7%94%a8GraphQL%20Java%e5%92%8cSpring%20Boot" target="_blank" title="Share on Douban ">
            <i class="iconfont icon-weibo"></i>
          </a>
          
</span>
                
            </p>

             
            <p class="copyright-item">
                Released under <a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a>
            </p>
            
    </div>

  
    <div class="post-tags">
        
        <section>
                <a href="javascript:window.history.back();">Back</a></span> Â· 
                <span><a href="https://example.com">Home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://example.com/ios-multi-language/" class="prev" rel="prev" title="iOSåº”ç”¨å†…å¤šè¯­è¨€åˆ‡æ¢çš„å¥‡æ€å¦™æƒ³"><i class="iconfont icon-dajiantou"></i>&nbsp;iOSåº”ç”¨å†…å¤šè¯­è¨€åˆ‡æ¢çš„å¥‡æ€å¦™æƒ³</a>
         
        
        <a href="https://example.com/kubead-in-centos7/" class="next" rel="next" title="kubeadmåœ¨CentOS7ä¸‹å®‰è£…æç¤º">kubeadmåœ¨CentOS7ä¸‹å®‰è£…æç¤º&nbsp;<i class="iconfont icon-xiaojiantou"></i></a>
        
    </div>

    <div class="post-comment">
          
          <div id="disqus_thread"></div>
    <script type="text/javascript">
    (function() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'yourdiscussshortname';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  

 


          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">1994 - 2019</span>
        
          <span> | TomorJM â¤ï¸</span>

    </div>
</footer>













    
     <link href="//lib.baomitu.com/lightgallery/1.6.12/css/lightgallery.min.css" rel="stylesheet">  
      
     <script src="/js/vendor_gallery.min.js" async="" ></script>
    
  







     </div>
  </body>
</html>
